# 如何设计聊天功能

聊天，相信大家都不陌生，每天都可能在使用。基本的聊天需包含: 文字，语音，视频聊天；还需支持多媒体，例如图片，音视频的上传；表情包，已读状态，在线情况, 是否需要端到端加密等等。

设计聊天功能之前，我们应该先弄清楚一个基本问题: **需要设计一个什么样的聊天系统?** 不同类的聊天系统所需的架构自然不同，我们需要提出和实现最符合业务需求的架构。例如专注一对一和专注office群聊的架构就会很不同。

我们这里主要讨论**移动端的架构设计**，后台部分则会浅尝辄止。

## 需求
目前市面上比较流行的聊天软件分两类侧重: **一对一互动**和**群体互动**。微信，WhatsApp专注于一对一；Slack，Teams专注于工作群聊，Discord则专注于大群体互动。

一般来说，聊天软件都支持私聊和群聊，侧重不同，架构也不同。若侧重私聊, 则点对点之间的隐私保护早就非常重要，可能需要端到端加密，我们就得有一个或者多个加解密模块; 若侧重群聊, 我们可能需要权限模块来区分群主，管理员以及其他角色，甚至于被禁言的群友等等。

在这里，我们设计一个**以工作群聊为主，实现端到端加密**的聊天功能。

## 架构
